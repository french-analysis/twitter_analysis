import tweepy
import json
from tweepy import OAuthHandler
from config import consumer_key, consumer_secret, access_token, access_secret
from tweepy import Stream
from tweepy.streaming import StreamListener

class tweetListener(StreamListener): 

    i = 0

    def on_data(self, data):
        print(type(data))
        try:
            with open('twitter_stream.txt', 'w') as outfile:
                json_data = json.loads(data)
                json.dump(json_data,outfile)
        except BaseException as e:
            print("Error on_data: %s" % str(e))
        return True
 
    def on_error(self, status):
        print(status)

if __name__ == "__main__":

    auth = OAuthHandler(consumer_key, consumer_secret)
    auth.set_access_token(access_token, access_secret)
    twitter_api = tweepy.API(auth)

    twitter_stream = Stream(auth, tweetListener())
    try:
        twitter_stream.filter(follow=['417996743', '487874704', '834484970253144064', '507763648', '2991982659', '58297781', '37509285', '509190573', '295315699', '522332384', '731579705237835780', '490209951', '829395681093808128', '875444314138173441', '1135336670', '854077004337094665', '716512361713164290', '87489252', '2155545900', '204017834', '85560978', '414473247', '86337508', '801121064357085184', '21076121', '184494426', '2822339036', '733336272861843456', '126476222', '14624332', '856253102', '128193181', '1873014044', '451647746', '572138913', '373645483', '312905403', '282119887', '840486447547338753', '360900415', '785632847256182784', '243100036', '796098812884512768', '851150317823590400', '3423885022', '162335425', '869583647313195009', '479593666', '4906771210', '14237828', '141268691', '161971690', '2556950432', '763456474383253504', '382775868', '863800772248707072', '20147475', '2875678452', '3191307777', '4835953443', '2546864456', '572399084', '612498887', '207903949', '4140694923', '1104939096', '74974747', '269430085', '716518184686395393', '553627693', '7883542', '1456450406', '443773558', '47617270', '21242697', '134784938', '365534796', '842509270696558592', '492949714', '762587880124448768', '401964696', '2381719949', '783591878080000000', '1212492271', '861537834624266240', '576195038', '733402783605350402', '795816308', '2887902767', '1027151647', '435879159', '168667495', '4729709060', '363061009', '3235836113', '582088237', '51016037', '4784546207', '1255991936', '1072010388', '23783434', '17945103', '849255749746397186', '264248834', '115411260', '440957360', '3719159895', '1041928376', '864856251439755264', '874152094516879361', '190323833', '28156365', '455582921', '120061742', '1561701488', '3492252436', '735414116', '227348879', '23862177', '697595717842571269', '805239846180634624', '1229343240', '174358985', '863661440175132672', '2879303663', '790488634772299777', '465033569', '731085207827271680', '805867093065396225', '1496134926', '758504', '194689994', '48760497', '744979229297762304', '19152286', '158850785', '570118944', '495067611', '10908772', '86069514', '463256925', '194114947', '751037386176552960', '327935366', '46368255', '859633199537848320', '873891191389081600', '559430796', '470903149', '806666977980858381', '867820890368741380', '492995382', '825887020224491520', '872962299501391874', '1153905794', '861828110995599360', '869494596274978817', '544086238', '468654580', '2552953351', '37774070', '408495613', '1568568853', '4171585120', '377977869', '4425478216', '53011010', '767228583605567488', '872914005303726081', '716942563', '2397511182', '866288725931831296', '818106323065798656', '864104483395166208', '3109824238', '824648935725789184', '871685444668411905', '800435764966215680', '848559289719508992', '91404551', '833030712844546052', '22276313', '126477168', '226682775', '823596473371729920', '4235113371', '848923220728262656', '87911494', '604582187', '829959828219056128', '2445151418', '301726804', '872161536156069893', '862190399938539520', '284635671', '593747196', '864078416747909120', '434868834', '232511465', '17743036', '2806118739', '299760936', '842070237637947395', '836162120970616834', '836484117952880640', '2510021652', '1613194490', '223113697', '2394100646', '865305435707985921', '1264961534', '3418948093', '3356762033', '95473950', '26071122', '38244333', '3055432720', '118207817', '49444134', '1534732470', '244766726', '2581952822', '3089821899', '800060796554317824', '830051534243258369', '1901519893', '1533565386', '871299625390678016', '849343479553687552', '806254362850902018', '1339668680', '862955797260754944', '339852539', '953021798', '716689847138848770', '871059795335421952', '384880877', '794469571382149120', '864770818689171456', '1576264982', '47315521', '806865153472004097', '828314987580026881', '109567991', '873963097', '816907545172471808', '186393791', '219799299', '38535159', '2240464225', '485819426', '1063530872', '866659396667019266', '804341861536108544', '2377094179', '851756130774777857', '809112131446640640', '1490465155', '714930185838202880', '4815025420', '15724364', '839080981281837056', '257521747', '4813171035', '581937555', '182761344', '489822574', '2496054908', '176333296', '834823917156048896', '2778675109', '760842327959171072', '2447020950', '1899596384', '420992473', '775063553439064071', '384229766', '360019007', '35200436', '1387151082', '1458716720', '263749696', '809386582037954561', '95998625', '831949612281888768', '39369357', '866413487723040771', '59290869', '91545957', '416596130', '2160037648', '1930636796', '863488932180316160', '819840320389218305', '332824252', '2285097206', '403034488', '21996647', '156032740', '125120337', '758972977585147904', '1104605268', '317655205', '385429773', '35712322', '807901725113851904', '50819027', '739838796020219905', '1395196428', '1690691120', '813667831925575680', '479868786', '708034964735053824', '342735511', '162328437', '8223272', '1691245939', '735529583412424704', '15980161', '87733061', '2157271192', '733339165379731458', '803977791779782656', '360540433', '457444998', '476583783', '2348648162', '828693616281415682', '863649665585119232', '4061539971', '61594306', '868211905755795456', '739098870844690432', '868421037213593601', '765559117830316032', '242505426', '868161505795219456', '709643005842595841', '3971835161', '3851225007', '791195141679751168', '371214149', '863041178433978368', '576953168', '497707622', '54874713', '833706705234120704', '39601053', '925576573', '834402799328907264', '867533124724555776', '849228281358495744', '858653276', '862297691245740032', '341138616', '159062483', '731544444441382912', '556602197', '3844120037', '2383700000', '2858943741', '406546103', '3031114174', '301964061', '53030642', '850984946063859716', '729414744', '2938234595', '314666622', '299294561', '867048412356673536', '786926081383301121', '712344826151378944', '1233765144', '2274916279', '514312081', '864426054827601920', '531085561', '566073175', '1369701486', '157449003', '422572351', '969728082', '864926925734772736', '590854559', '3707794701', '1092822246', '1566019675', '836521059176304640', '23967604', '826913783096475648', '473087256', '827084507815747585', '4891545353', '864165870213500928', '839597613330677760', '805751952659320832', '4030820475', '822682853926387712', '2926489797', '122155194', '839861124480786432', '826062874133028864', '717264370506539008', '702550434', '811615099194605569', '1364650009', '866324403541430273', '2382757129', '866509140570648576', '456526676', '1262688433', '150659777', '246982313', '1945306862', '831174660163244040', '799186658667204608', '865482011523166209', '161285397', '798832374905585665', '866308320193384448', '864422248832172033', '332436619', '846253610027626496', '28335350', '862640476700250113', '137614014', '865977335299940353', '792708415764258816', '552577695', '864116167841116160', '794616080924835840', '2359346816', '4844556311', '42028934', '795129902265749504', '81853625', '772215918868979712', '780633908', '1889845682', '856372598816604160', '516383400', '1956743750', '35769552', '797807365215109121', '856838232', '722836423', '865873548262428672', '726789307047022593', '825439710797508609', '865113274693681152', '29459243', '863367145073324032', '3092396308', '972842100', '803407245405024256', '2592523722', '2267962939', '1879461019', '2659826970', '2614595097', '838157711183339525', '2245764085', '392729312', '242126833', '2911274113', '14598197', '106225124', '865191903477850113', '15742916', '825100929976381441', '832360646675152896', '865092050341031936', '2729817725', '824158914149289985', '864206680648810496', '783594383203561472', '864584437312442368', '827933915239288832', '864940698084274176', '125311300', '1553363869', '815542921', '959321', '4749354919', '739798273641328641', '800702346221142016', '844978158113820674', '220956537', '1065328256', '76286693', '828966118287106052', '833954453669691393', '857178782536478720', '816402208732352513', '179217876', '861871602862100480', '2433624242', '862208620863377417', '862999383499042816', '49638206', '3231538425', '864451648491540480', '121988141', '786930238622142465', '745296257007161345', '236059999', '325182875', '741675786', '391865420', '2610957309', '862368731263102978', '358505221', '723880368290586625', '235555499', '716657849707970561', '2252462749', '829614011989815296', '606383465', '793915884959956992', '752791126373957632', '4451804387', '93733422', '2891258315', '545924100', '248869046', '1328646018', '815962270870237185', '1466840454', '291203474', '48075053', '780131738592874497', '49037826', '796341498891632640', '3358681043', '48317365', '1367158159', '2481713529', '786904988169666560', '819478218864463872', '797463550549757953', '741290785157591040', '1196781259', '204019648', '26232866', '214610115', '400294503', '788349970026037248', '100317446', '3401207499', '481574914', '1062924253', '2184701822', '592591345', '804783131593162756', '97642753', '299603964', '799622890094231552', '105484908', '47765619', '31865940', '164604827', '3064867145', '2172011132', '410165915', '795575944660533248', '863718230950653953', '1288115372', '4296059003'])
    except Exception as e:
        print(e.__doc__) 
